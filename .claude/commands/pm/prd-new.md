---
allowed-tools: Bash, Read, Write, LS
---

# PRD 新建

为新产品需求文档启动头脑风暴。

## 用法
```
/pm:prd-new <feature_name>
```

## 必需规则

**重要**：执行此命令前，请阅读并遵循：
- `.claude/rules/datetime.md` - 获取真实的当前日期/时间

## 飞行前检查清单

在继续之前，完成这些验证步骤。
不要用飞行前检查进度打扰用户（"我不会..."）。只需完成它们并继续。

### 输入验证
1. **验证功能名称格式：**
   - 必须只包含小写字母、数字和连字符
   - 必须以字母开头
   - 不允许空格或特殊字符
   - 如果无效，告诉用户："❌ 功能名称必须是 kebab-case（仅小写字母、数字、连字符）。示例：user-auth、payment-v2、notification-system"

2. **检查现有 PRD：**
   - 检查 `.claude/prds/$ARGUMENTS.md` 是否已存在
   - 如果存在，询问用户："⚠️ PRD '$ARGUMENTS' 已存在。您要覆盖它吗？（yes/no）"
   - 只有在明确确认 'yes' 时才继续
   - 如果用户说 no，建议："使用不同的名称或运行：/pm:prd-parse $ARGUMENTS 从现有 PRD 创建史诗"

3. **验证目录结构：**
   - 检查 `.claude/prds/` 目录是否存在
   - 如果不存在，先创建它
   - 如果无法创建，告诉用户："❌ 无法创建 PRD 目录。请手动创建：.claude/prds/"

## 指令

您是为 **$ARGUMENTS** 创建全面产品需求文档（PRD）的产品经理。

遵循这个结构化方法：

### 1. 发现和上下文
- 询问关于功能/产品 "$ARGUMENTS" 的澄清问题
- 了解正在解决的问题
- 识别目标用户和用例
- 收集约束和需求

### 2. PRD 结构
创建包含这些部分的全面 PRD：

#### 执行摘要
- 简要概述和价值主张

#### 问题陈述
- 我们在解决什么问题？
- 为什么现在很重要？

#### 用户故事
- 主要用户角色
- 详细的用户旅程
- 正在解决的痛点

#### 需求
**功能需求**
- 核心功能和能力
- 用户交互和流程

**非功能需求**
- 性能期望
- 安全考虑
- 可扩展性需求

#### 成功标准
- 可衡量的结果
- 关键指标和 KPI

#### 约束和假设
- 技术限制
- 时间限制
- 资源限制

#### 范围外
- 我们明确不构建什么

#### 依赖关系
- 外部依赖
- 内部团队依赖

### 3. 带 Frontmatter 的文件格式
将完成的 PRD 保存到：`.claude/prds/$ARGUMENTS.md`，使用这个确切的结构：

```markdown
---
name: $ARGUMENTS
description: [PRD 的简要一行描述]
status: backlog
created: [当前 ISO 日期/时间]
---

# PRD: $ARGUMENTS

## 执行摘要
[内容...]

## 问题陈述
[内容...]

[继续所有部分...]
```

### 4. Frontmatter 指南
- **name**：使用确切的功能名称（与 $ARGUMENTS 相同）
- **description**：编写此 PRD 涵盖内容的简洁一行摘要
- **status**：新 PRD 始终以 "backlog" 开始
- **created**：通过运行获取真实当前日期时间：`date -u +"%Y-%m-%dT%H:%M:%SZ"`
  - 永远不要使用占位符文本
  - 必须是 ISO 8601 格式的实际系统时间

### 5. 质量检查

保存 PRD 前，验证：
- [ ] 所有部分都已完成（无占位符文本）
- [ ] 用户故事包含验收标准
- [ ] 成功标准是可衡量的
- [ ] 依赖关系已明确识别
- [ ] 范围外项目已明确列出

### 6. 创建后

成功创建 PRD 后：
1. 确认："✅ PRD 已创建：.claude/prds/$ARGUMENTS.md"
2. 显示捕获内容的简要摘要
3. 建议下一步："准备好创建实施史诗了吗？运行：/pm:prd-parse $ARGUMENTS"

## 错误恢复

如果任何步骤失败：
- 清晰解释出了什么问题
- 提供修复问题的具体步骤
- 永远不要留下部分或损坏的文件

在编写 PRD 之前进行彻底的头脑风暴会议。提问、探索边缘情况，并确保全面覆盖 "$ARGUMENTS" 的功能需求。